<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FOR ALL HOME CARE AND AGENCY LLC</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="api-client-supabase.js"></script>
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
        'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
        sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;
    
    // Lucide React icons as inline SVG components
    const Calendar = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="16" y1="2" x2="16" y2="6"></line>
        <line x1="8" y1="2" x2="8" y2="6"></line>
        <line x1="3" y1="10" x2="21" y2="10"></line>
      </svg>
    );

    const ClipboardList = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
        <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
        <path d="M12 11h4"></path>
        <path d="M12 16h4"></path>
        <path d="M8 11h.01"></path>
        <path d="M8 16h.01"></path>
      </svg>
    );

    const CheckCircle = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
      </svg>
    );

    const XCircle = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="15" y1="9" x2="9" y2="15"></line>
        <line x1="9" y1="9" x2="15" y2="15"></line>
      </svg>
    );

    const Download = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
    );

    const Trash2 = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="3 6 5 6 21 6"></polyline>
        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        <line x1="10" y1="11" x2="10" y2="17"></line>
        <line x1="14" y1="11" x2="14" y2="17"></line>
      </svg>
    );

    const Users = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
        <circle cx="9" cy="7" r="4"></circle>
        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
      </svg>
    );

    const FileText = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
        <polyline points="14 2 14 8 20 8"></polyline>
        <line x1="16" y1="13" x2="8" y2="13"></line>
        <line x1="16" y1="17" x2="8" y2="17"></line>
        <polyline points="10 9 9 9 8 9"></polyline>
      </svg>
    );

    const Info = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>
    );

    const Cloud = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path>
      </svg>
    );

    const Shield = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
      </svg>
    );

    const RefreshCw = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polyline points="23 4 23 10 17 10"></polyline>
        <polyline points="1 20 1 14 7 14"></polyline>
        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
      </svg>
    );

    const Zap = (props) => (
      <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
      </svg>
    );

    // Import the component code from your JSX file
    function HomeCareAgencySystem() {
      // Check if admin mode is enabled via URL parameter
      const isAdmin = new URLSearchParams(window.location.search).get('admin') === 'true';
      
      const [activeTab, setActiveTab] = useState('appointments');
      const [showForm, setShowForm] = useState(true);
      
      // Client form state
      const [clientInfo, setClientInfo] = useState({
        evaluatorName: '',
        evaluatorSignature: '',
        parentGuardianName: '',
        clientName: '',
        serviceProviderName: '',
        email: '',
        phone: '',
        address: '',
        appointmentDate: '',
        appointmentTime: '',
        serviceType: [],
        notes: ''
      });
      
      const [evaluationType, setEvaluationType] = useState('staff');
      const [evaluationData, setEvaluationData] = useState({});
      const [errors, setErrors] = useState({});
      const [submitted, setSubmitted] = useState(false);
      
      // Data storage
      const [appointments, setAppointments] = useState([]);
      const [evaluations, setEvaluations] = useState([]);
      const [showPowerAppsInfo, setShowPowerAppsInfo] = useState(true);

      // Load data from localStorage on mount
      useEffect(() => {
        const loadData = async () => {
          // Clear old localStorage data from pre-UUID era to avoid conflicts
          try {
            const storedAppointments = localStorage.getItem('homeCareAppointments');
            if (storedAppointments) {
              const appointments = JSON.parse(storedAppointments);
              // If appointments have numeric string IDs (not UUIDs), clear them
              if (appointments.length > 0 && appointments[0].id && appointments[0].id.match(/^\d+$/)) {
                console.log('ðŸ§¹ Clearing old localStorage data (numeric IDs, migrating to UUID)');
                localStorage.removeItem('homeCareAppointments');
                localStorage.removeItem('homeCareEvaluations');
              }
            }
          } catch (e) {
            console.log('Migration check: no issues found');
          }
          
          // Load fresh data from Supabase
          try {
            const [appointmentsData, evaluationsData] = await Promise.all([
              HomeCareAPI.getAppointments(),
              HomeCareAPI.getEvaluations()
            ]);
            
            const appointments = appointmentsData?.appointments || [];
            const evaluations = evaluationsData?.evaluations || [];
            
            setAppointments(appointments);
            setEvaluations(evaluations);
            localStorage.setItem('homeCareAppointments', JSON.stringify(appointments));
            localStorage.setItem('homeCareEvaluations', JSON.stringify(evaluations));
            console.log('âœ… Data loaded from Supabase:', appointments.length, 'appointments');
          } catch (error) {
            console.error('âš ï¸ Supabase load failed:', error.message);
          }
        };
        
        loadData();
      }, []);

      const serviceTypes = [
        'Homemaker',
        'Personal Care',
        'Community Connection',
        'Supported Community Connection',
        'Respite',
        'Mentorship'
      ];

      const staffServiceQuestions = [
        { id: 'q1', question: 'Was the staff punctual and consistent with scheduled visits?', type: 'yesnosometimes' },
        { id: 'q2', question: 'Was the staff respectful, kind, and professional during visits?', type: 'yesnosometimes' },
        { id: 'q3', question: 'Did the staff complete all assigned duties (cleaning, laundry, cooking, outings, etc.) as expected?', type: 'yesnopartially' },
        { id: 'q4', question: 'Does the staff communicate well and follow instructions or care plans?', type: 'yesnosometimes' },
        { id: 'q5', question: 'Is the staff dressed cleanly and appropriately to provide services?', type: 'yesnosometimes' },
        { id: 'q6', question: 'Do you feel comfortable and safe having this staff in your home?', type: 'yesnosomewhat' },
        { id: 'q7', question: 'Do you feel your loved one is benefiting from the services being provided?', type: 'yesnonotsure' },
        { id: 'q8', question: 'How would you rate the quality of services received?', type: 'rating5' },
        { id: 'q9', question: 'Is your coordinator responsive and helpful in resolving any concerns?', type: 'yesnosometimes' },
        { id: 'q10', question: 'Has there been any previous incident or concern involving this staff that remains unresolved?', type: 'yesnonotsure', hasDescription: true },
        { id: 'q10_desc', question: 'If yes, please describe:', type: 'textarea', conditional: true },
        { id: 'q11', question: 'Has any inappropriate incident or behavior been reported involving this staff?', type: 'yesnonotsure', hasDescription: true },
        { id: 'q11_desc', question: 'If yes, please describe:', type: 'textarea', conditional: true },
        { id: 'q12', question: 'Has the staff failed to follow instructions or complete assigned tasks as expected?', type: 'yesnosometimes', hasDescription: true },
        { id: 'q12_desc', question: 'If yes, please describe:', type: 'textarea', conditional: true },
        { id: 'q13', question: 'Would you like to continue services with this staff?', type: 'yesnonotsure' },
        { id: 'q14', question: 'Any concerns, complaints, or suggestions for improvement?', type: 'textarea' }
      ];

      const parentalProviderQuestions = [
        { id: 'q1', question: 'Do you feel the services you provide are helping your child/family reach goals and maintain daily stability?', type: 'yesnosomewhat' },
        { id: 'q2', question: 'Since you began providing these services, have you noticed improvement in your child\'s or family\'s overall well-being?', type: 'yesnonotsure', hasDescription: true },
        { id: 'q2_desc', question: 'If yes, please describe briefly:', type: 'textarea', conditional: true },
        { id: 'q3', question: 'Does our agency provide the support, guidance, and resources you need to continue your role as a parental provider?', type: 'alwayssometimesrarely' },
        { id: 'q4', question: 'Is your assigned coordinator helpful and available when you have questions or need assistance?', type: 'yesnosometimes' },
        { id: 'q5', question: 'Are your questions about timesheets, billing, or EVV check-in/check-out answered promptly?', type: 'yesnosometimes' },
        { id: 'q6', question: 'Do you find the EVV app (check-in/check-out process) easy to use?', type: 'evvrating' },
        { id: 'q7', question: 'How would you describe your compensation?', type: 'compensation' },
        { id: 'q8', question: 'Do you believe the allotted service hours are enough to meet your client\'s needs?', type: 'yesnonotsure' },
        { id: 'q9', question: 'Would you like to continue providing services as a parental provider?', type: 'yesnoundecided' },
        { id: 'q10', question: 'Overall, how would you rate the quality of services and agency support?', type: 'rating5' },
        { id: 'q11', question: 'Do you have any complaints, challenges, or areas where the agency could improve?', type: 'textarea' },
        { id: 'q12', question: 'What suggestions or feedback would you like to share to improve the program?', type: 'textarea' }
      ];

      const currentQuestions = evaluationType === 'staff' ? staffServiceQuestions : parentalProviderQuestions;

      const today = new Date().toISOString().split('T')[0];
      const maxDate = new Date();
      maxDate.setMonth(maxDate.getMonth() + 3);
      const maxDateStr = maxDate.toISOString().split('T')[0];

      const validateForm = () => {
        const newErrors = {};
        
        if (!clientInfo.evaluatorName.trim()) newErrors.evaluatorName = 'Evaluator name is required';
        if (!clientInfo.parentGuardianName.trim()) newErrors.parentGuardianName = 'Parent/Guardian name is required';
        if (!clientInfo.clientName.trim()) newErrors.clientName = 'Client name is required';
        if (!clientInfo.serviceProviderName.trim()) newErrors.serviceProviderName = 'Service provider name is required';
        if (!clientInfo.email.trim()) {
          newErrors.email = 'Email is required';
        } else if (!/\S+@\S+\.\S+/.test(clientInfo.email)) {
          newErrors.email = 'Email is invalid';
        }
        if (!clientInfo.phone.trim()) newErrors.phone = 'Phone is required';
        if (!clientInfo.address.trim()) newErrors.address = 'Address is required';
        if (!clientInfo.appointmentDate) newErrors.appointmentDate = 'Date is required';
        if (!clientInfo.appointmentTime) newErrors.appointmentTime = 'Time is required';
        if (clientInfo.serviceType.length === 0) newErrors.serviceType = 'Select at least one service type';

        currentQuestions.forEach(q => {
          if (!q.conditional && !evaluationData[q.id] && q.type !== 'textarea') {
            newErrors[q.id] = 'This field is required';
          }
        });

        setErrors(newErrors);
        return Object.keys(newErrors).length === 0;
      };

      const handleSubmit = async (e) => {
        e.preventDefault();
        
        if (validateForm()) {
          const timestamp = new Date().toISOString();
          const appointmentId = Date.now();

          const newAppointment = {
            id: appointmentId,
            ...clientInfo,
            status: 'pending',
            submittedAt: timestamp
          };

          const newEvaluation = {
            id: Date.now() + 1,
            appointmentId,
            evaluationType,
            evaluatorName: clientInfo.evaluatorName,
            evaluatorSignature: evaluationData.evaluatorSignature || clientInfo.evaluatorSignature,
            parentGuardianName: clientInfo.parentGuardianName,
            clientName: clientInfo.clientName,
            serviceProviderName: clientInfo.serviceProviderName,
            serviceType: clientInfo.serviceType,
            email: clientInfo.email,
            responses: currentQuestions.map(q => ({
              questionId: q.id,
              question: q.question,
              answer: evaluationData[q.id] || 'Not answered',
              type: q.type
            })),
            submittedAt: timestamp
          };

          // ALWAYS save to localStorage first (for GitHub Pages)
          const updatedAppointments = [...appointments, newAppointment];
          const updatedEvaluations = [...evaluations, newEvaluation];
          
          setAppointments(updatedAppointments);
          setEvaluations(updatedEvaluations);
          
          localStorage.setItem('homeCareAppointments', JSON.stringify(updatedAppointments));
          localStorage.setItem('homeCareEvaluations', JSON.stringify(updatedEvaluations));
          console.log('âœ… Data saved to localStorage:', newAppointment);

          // Try to also save to backend API (if available)
          try {
            const appointmentDataWithEvaluation = {
              ...newAppointment,
              evaluation: newEvaluation
            };
            const result = await HomeCareAPI.submitAppointment(appointmentDataWithEvaluation);
            console.log('âœ… Data saved to Supabase:', result);
          } catch (error) {
            console.error('âŒ Supabase save failed:', error);
            alert(`âš ï¸ WARNING: Data saved locally but NOT to database!\n\nError: ${error.message}\n\nPlease check your internet connection.`);
          }

          setSubmitted(true);
        }
      };

      const handleReset = () => {
        setClientInfo({
          evaluatorName: '',
          evaluatorSignature: '',
          parentGuardianName: '',
          clientName: '',
          serviceProviderName: '',
          email: '',
          phone: '',
          address: '',
          appointmentDate: '',
          appointmentTime: '',
          serviceType: [],
          notes: ''
        });
        setEvaluationData({});
        setErrors({});
        setSubmitted(false);
        setShowForm(true);
      };

      const updateAppointmentStatus = async (id, newStatus) => {
        // Update UI immediately
        const updated = appointments.map(apt => 
          apt.id === id ? { ...apt, status: newStatus } : apt
        );
        setAppointments(updated);
        localStorage.setItem('homeCareAppointments', JSON.stringify(updated));

        // Find the appointment details for calendar event
        const apt = appointments.find(a => a.id === id);

        // Then sync with server in background
        try {
          await HomeCareAPI.updateAppointmentStatus(id, newStatus);
          console.log('âœ… Status updated on server');

          // If approved, open Google Calendar event link
          if (newStatus === 'approved' && apt) {
            // Build start/end datetime in RFC3339 (YYYYMMDDTHHMMSSZ)
            const date = apt.appointmentDate || apt.date || '';
            const time = (apt.appointmentTime || '09:00').padEnd(5, '0');
            // Assume 1 hour duration
            const start = date.replace(/-/g, '') + 'T' + time.replace(':', '') + '00';
            const endHour = String(Number(time.split(':')[0]) + 1).padStart(2, '0');
            const end = date.replace(/-/g, '') + 'T' + endHour + time.slice(2) + '00';
            const text = encodeURIComponent('Home Care Visit: ' + (apt.clientName || ''));
            const details = encodeURIComponent('Service Provider: ' + (apt.serviceProviderName || '') + '\nNotes: ' + (apt.notes || ''));
            const location = encodeURIComponent(apt.address || '');
            const url = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${text}&dates=${start}/${end}&details=${details}&location=${location}`;
            window.open(url, '_blank');
          }
        } catch (error) {
          console.warn('âš ï¸ Server update failed, but localStorage is updated');
        }
      };

      const deleteAppointment = async (id) => {
        // Delete from UI and localStorage immediately
        const updated = appointments.filter(apt => apt.id !== id);
        const updatedEvals = evaluations.filter(ev => ev.appointmentId !== id);
        
        setAppointments(updated);
        setEvaluations(updatedEvals);
        localStorage.setItem('homeCareAppointments', JSON.stringify(updated));
        localStorage.setItem('homeCareEvaluations', JSON.stringify(updatedEvals));
        
        // Then try to delete from server in background
        try {
          await HomeCareAPI.deleteAppointment(id);
          console.log('âœ… Appointment deleted from server');
        } catch (error) {
          console.warn('âš ï¸ Server unavailable, but localStorage is updated');
        }
      };

      const deleteEvaluation = async (id) => {
        // Delete from UI and localStorage immediately
        const updated = evaluations.filter(ev => ev.id !== id);
        setEvaluations(updated);
        localStorage.setItem('homeCareEvaluations', JSON.stringify(updated));
        
        // Then try to delete from server in background
        try {
          await HomeCareAPI.deleteEvaluation(id);
          console.log('âœ… Evaluation deleted from server');
        } catch (error) {
          console.warn('âš ï¸ Server unavailable, but localStorage is updated');
        }
      };

      const refreshFromServer = async () => {
        try {
          console.log('ðŸ”„ Refreshing data from Supabase...');
          const [appointmentsData, evaluationsData] = await Promise.all([
            HomeCareAPI.getAppointments(),
            HomeCareAPI.getEvaluations()
          ]);
          
          if (appointmentsData) {
            setAppointments(appointmentsData);
            setEvaluations(evaluationsData || []);
            localStorage.setItem('homeCareAppointments', JSON.stringify(appointmentsData));
            localStorage.setItem('homeCareEvaluations', JSON.stringify(evaluationsData || []));
            console.log('âœ… Data refreshed:', appointmentsData.length, 'appointments,', (evaluationsData || []).length, 'evaluations');
            alert(`âœ… Refreshed: ${appointmentsData.length} appointments, ${(evaluationsData || []).length} evaluations`);
          }
        } catch (error) {
          console.error('âŒ Refresh failed:', error);
          alert('âŒ Failed to refresh from Supabase. Please check your connection and try again.');
        }
      };

      const formatDate = (dateString) => {
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        return new Date(dateString).toLocaleDateString('en-US', options);
      };

      const formatTime = (timeString) => {
        if (!timeString) return '';
        const [hours, minutes] = timeString.split(':');
        const hour = parseInt(hours);
        
        // Validate time range
        if (isNaN(hour) || hour < 0 || hour > 23) {
          return 'Invalid Time';
        }
        if (!minutes || isNaN(parseInt(minutes))) {
          return 'Invalid Time';
        }
        
        const ampm = hour >= 12 ? 'PM' : 'AM';
        const displayHour = hour === 0 ? 12 : hour > 12 ? hour - 12 : hour;
        return `${displayHour}:${minutes} ${ampm}`;
      };

      const formatDateTime = (isoString) => {
        return new Date(isoString).toLocaleString('en-US', { 
          month: 'short', 
          day: 'numeric', 
          year: 'numeric',
          hour: '2-digit', 
          minute: '2-digit' 
        });
      };

      const toggleServiceType = (type) => {
        const current = clientInfo.serviceType;
        if (current.includes(type)) {
          setClientInfo({...clientInfo, serviceType: current.filter(t => t !== type)});
        } else {
          setClientInfo({...clientInfo, serviceType: [...current, type]});
        }
      };



      const exportToWord = () => {
        if (evaluations.length === 0) {
          alert('No evaluations to export. Please submit some evaluations first.');
          return;
        }

        const logoBase64 = '/9j/4AAQSkZJRgABAQEAeAB4AAD/4QL4RXhpZgAATU0AKgAAAAgABAE7AAIAAAAPAAABSodpAAQAAAABAAABWpydAAEAAAAeAAAC0uocAAcAAAEMAAAAPgAAAAAc6gAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWW9oYW5uZXMgQXJlZGEAAAAFkAMAAgAAABQAAAKokAQAAgAAABQAAAK8kpEAAgAAAAMxNQAAkpIAAgAAAAMxNQAA6hwABwAAAQwAAAGcAAAAABzqAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAyMDI1OjAxOjA1IDE3OjM3OjU0ADIwMjU6MDE6MDUgMTc6Mzc6NTQAAABZAG8AaABhAG4AbgBlAHMAIABBAHIAZQBkAGEAAAD/4QQhaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49J++7vycgaWQ9J1c1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCc/Pg0KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyI+PHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIvPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wMS0wNVQxNzozNzo1NC4xNTI8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj48ZGM6Y3JlYXRvcj48cmRmOlNlcSB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPjxyZGY6bGk+WW9oYW5uZXMgQXJlZGE8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PC9yZGY6UkRGPjwveDp4bXBtZXRhPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/eHBhY2tldCBlbmQ9J3cnPz7/2wBDAAcFBQYFBAcGBQYIBwcIChELCgkJChUPEAwRGBUaGRgVGBcbHichGx0lHRcYIi4iJSgpKywrGiAvMy8qMicqKyr/2wBDAQcICAoJChQLCxQqHBgcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKir/wAARCAHxAvEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD6RooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKD900AFFfNut/E7xna69fQW+qlYo53VF8peADx2rp/hV458TeIPGH2PWr8z2/kM2zy1HII9BXq1MrrU6TqNqyV/60CzPa6KKK8oAqC9vrXTbOS6v50ggjGWkc4ArE8WeNtJ8IWRkv5d9ww/d2yH53/wHvXzt4x8cav4xvC17KYrVT+7tozhV+vqfevSweX1MS7vSPf8AyHZnZeNvjheTXn2bwj+4gifLXLrlpcegPQV2XgH4t6f4nWOx1YpZanjAycJKfY9j7V86CAscKpJ9hQqMjBkJVgcgjtX0VTLMNKl7OKs116hys+0qK8E8BfF+60rytO8SlrmzGFS46vH9fUV7nY39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BRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf/9k=';

        const htmlParts = [];
        
        htmlParts.push('<!DOCTYPE html><html><head><meta charset="UTF-8">');
        htmlParts.push('<title>FOR ALL HOME CARE - Evaluations Report</title>');
        htmlParts.push('<style>');
        htmlParts.push('body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }');
        htmlParts.push('.logo-header { text-align: center; padding: 20px 0 30px 0; border-bottom: 3px solid #4F46E5; margin-bottom: 30px; }');
        htmlParts.push('.logo-img { max-width: 500px; height: auto; margin-bottom: 24px; padding: 20px 0; }');
        htmlParts.push('h1 { color: #4F46E5; border-bottom: 3px solid #4F46E5; padding-bottom: 10px; }');
        htmlParts.push('.evaluation { page-break-after: always; margin-bottom: 40px; border: 1px solid #ddd; padding: 20px; }');
        htmlParts.push('.eval-header { background: #EEF2FF; padding: 15px; margin: -20px -20px 20px -20px; }');
        htmlParts.push('.eval-type { color: #10B981; font-weight: bold; font-size: 18px; }');
        htmlParts.push('.info-grid { margin: 20px 0; }');
        htmlParts.push('.info-label { font-weight: bold; color: #4F46E5; display: inline-block; width: 150px; }');
        htmlParts.push('.qa-section { margin: 20px 0; }');
        htmlParts.push('.question { font-weight: bold; color: #1F2937; margin: 15px 0 5px 0; }');
        htmlParts.push('.answer { color: #059669; margin-left: 20px; padding: 8px; background: #F0FDF4; border-left: 3px solid #10B981; }');
        htmlParts.push('</style></head><body>');
        
        htmlParts.push('<div class="logo-header">');
        htmlParts.push('<img src="data:image/jpeg;base64,' + logoBase64 + '" class="logo-img" alt="FOR ALL HOME CARE AND AGENCY LLC">');
        htmlParts.push('</div>');
        
        htmlParts.push('<h2 style="color: #4F46E5;">Evaluation Report</h2>');
        htmlParts.push('<p><strong>Generated:</strong> ' + new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric', hour: '2-digit', minute: '2-digit' }) + '</p>');
        htmlParts.push('<p><strong>Total Evaluations:</strong> ' + evaluations.length + '</p><hr>');

        evaluations.forEach((ev, index) => {
          htmlParts.push('<div class="evaluation">');
          htmlParts.push('<div class="eval-header">');
          htmlParts.push('<div class="eval-type">' + (ev.evaluationType === 'staff' ? 'Staff/Service Evaluation' : 'Parental Provider Evaluation') + '</div>');
          htmlParts.push('<div style="font-size: 12px; color: #6B7280; margin-top: 5px;">Evaluation #' + (index + 1) + ' - Submitted ' + formatDateTime(ev.submittedAt) + '</div>');
          htmlParts.push('</div>');
          
          htmlParts.push('<div class="info-grid">');
          htmlParts.push('<p><span class="info-label">Evaluation ID:</span>' + ev.id + '</p>');
          htmlParts.push('<p><span class="info-label">Appointment ID:</span>' + ev.appointmentId + '</p>');
          htmlParts.push('<p><span class="info-label">Evaluator:</span>' + ev.evaluatorName + '</p>');
          htmlParts.push('<p><span class="info-label">Parent/Guardian:</span>' + (ev.parentGuardianName || 'N/A') + '</p>');
          htmlParts.push('<p><span class="info-label">Client Name:</span>' + (ev.clientName || 'N/A') + '</p>');
          htmlParts.push('<p><span class="info-label">Service Provider:</span>' + (ev.serviceProviderName || 'N/A') + '</p>');
          htmlParts.push('<p><span class="info-label">Service Types:</span>' + (ev.serviceType || []).join(', ') + '</p>');
          htmlParts.push('<p><span class="info-label">Email:</span>' + ev.email + '</p>');
          htmlParts.push('</div>');
          
          htmlParts.push('<h3 style="color: #4F46E5; border-bottom: 2px solid #E0E7FF; padding-bottom: 5px;">Responses</h3>');
          htmlParts.push('<div class="qa-section">');
          
          (ev.responses || []).forEach((resp, qIndex) => {
            htmlParts.push('<div class="qa-pair" style="display: flex; align-items: baseline; margin-bottom: 8px;"><span class="question" style="font-weight: 500; margin-right: 8px;">' + (qIndex + 1) + '. ' + resp.question + ':</span><span class="answer" style="font-weight: 400; color: #1F2937;">' + resp.answer + '</span></div>');
          });
          
          htmlParts.push('</div>');
          
          if (ev.evaluatorSignature) {
            htmlParts.push('<div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #E0E7FF;">');
            htmlParts.push('<p style="color: #6B7280; font-size: 14px; margin-bottom: 10px;"><strong>Signature:</strong></p>');
            htmlParts.push('<p style="font-family: \"Brush Script MT\", cursive; font-size: 24px; color: #1F2937; font-style: italic;">' + ev.evaluatorSignature + '</p>');
            htmlParts.push('</div>');
          }
          
          htmlParts.push('</div>');
        });

        htmlParts.push('<div style="text-align: center; color: #6B7280; font-size: 12px; margin-top: 30px;">');
        htmlParts.push('<p>FOR ALL HOME CARE AND AGENCY LLC - Confidential Document</p>');
        htmlParts.push('<p>This report contains ' + evaluations.length + ' evaluation(s)</p>');
        htmlParts.push('</div>');
        htmlParts.push('</body></html>');

        const htmlContent = htmlParts.join('');
        const blob = new Blob([htmlContent], { type: 'application/msword' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `FOR_ALL_HOME_CARE_Evaluations_${new Date().toISOString().split('T')[0]}.doc`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      };

      const exportToPDF = () => {
        if (evaluations.length === 0) {
          alert('No evaluations to export. Please submit some evaluations first.');
          return;
        }

        const logoBase64 = '/9j/4AAQSkZJRgABAQEAeAB4AAD/4QL4RXhpZgAATU0AKgAAAAgABAE7AAIAAAAPAAABSodpAAQAAAABAAABWpydAAEAAAAeAAAC0uocAAcAAAEMAAAAPgAAAAAc6gAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWW9oYW5uZXMgQXJlZGEAAAAFkAMAAgAAABQAAAKokAQAAgAAABQAAAK8kpEAAgAAAAMxNQAAkpIAAgAAAAMxNQAA6hwABwAAAQwAAAGcAAAAABzqAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAyMDI1OjAxOjA1IDE3OjM3OjU0ADIwMjU6MDE6MDUgMTc6Mzc6NTQAAABZAG8AaABhAG4AbgBlAHMAIABBAHIAZQBkAGEAAAD/4QQhaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49J++7vycgaWQ9J1c1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCc/Pg0KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyI+PHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIvPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj48eG1wOkNyZWF0ZURhdGU+MjAyNS0wMS0wNVQxNzozNzo1NC4xNTI8L3htcDpDcmVhdGVEYXRlPjwvcmRmOkRlc2NyaXB0aW9uPjxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSJ1dWlkOmZhZjViZGQ1LWJhM2QtMTFkYS1hZDMxLWQzM2Q3NTE4MmYxYiIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj48ZGM6Y3JlYXRvcj48cmRmOlNlcSB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPjxyZGY6bGk+WW9oYW5uZXMgQXJlZGE8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PC9yZGY6UkRGPjwveDp4bXBtZXRhPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/eHBhY2tldCBlbmQ9J3cnPz7/2wBDAAcFBQYFBAcGBQYIBwcIChELCgkJChUPEAwRGBUaGRgVGBcbHichGx0lHRcYIi4iJSgpKywrGiAvMy8qMicqKyr/2wBDAQcICAoJChQLCxQqHBgcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKir/wAARCAHxAvEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD6RooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKD900AFFfNut/E7xna69fQW+qlYo53VF8peADx2rp/hV458TeIPGH2PWr8z2/kM2zy1HII9BXq1MrrU6TqNqyV/60CzPa6KKK8oAqC9vrXTbOS6v50ggjGWkc4ArE8WeNtJ8IWRkv5d9ww/d2yH53/wHvXzt4x8cav4xvC17KYrVT+7tozhV+vqfevSweX1MS7vSPf8AyHZnZeNvjheTXn2bwj+4gifLXLrlpcegPQV2XgH4t6f4nWOx1YpZanjAycJKfY9j7V86CAscKpJ9hQqMjBkJVgcgjtX0VTLMNKl7OKs116hys+0qK8E8BfF+60rytO8SlrmzGFS46vH9fUV7nY39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BRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf/9k=';

        const htmlParts = [];
        
        htmlParts.push('<!DOCTYPE html><html><head><meta charset="UTF-8">');
        htmlParts.push('<title>FOR ALL HOME CARE - Evaluations Report</title>');
        htmlParts.push('<style>');
        htmlParts.push('@media print { body { margin: 0; } .evaluation { page-break-after: always; } }');
        htmlParts.push('body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.4; }');
        htmlParts.push('.logo-header { text-align: center; padding: 0; border-bottom: 3px solid #4F46E5; margin-bottom: 0; }');
        htmlParts.push('.logo-img { max-width: 500px; height: auto; display: block; margin: 0 auto 24px auto; padding: 20px 0; }');
        htmlParts.push('h1 { color: #4F46E5; border-bottom: 3px solid #4F46E5; padding-bottom: 10px; }');
        htmlParts.push('h2 { margin: 5px 0 10px 0; padding: 0; }');
        htmlParts.push('p { margin: 5px 0; }');
        htmlParts.push('hr { margin: 10px 0; }');
        htmlParts.push('.evaluation { margin-bottom: 20px; border: 1px solid #ddd; padding: 15px; }');
        htmlParts.push('.eval-header { background: #EEF2FF; padding: 10px; margin: -15px -15px 15px -15px; }');
        htmlParts.push('.eval-type { color: #10B981; font-weight: bold; font-size: 18px; }');
        htmlParts.push('.info-grid { margin: 10px 0; }');
        htmlParts.push('.info-label { font-weight: bold; color: #4F46E5; display: inline-block; width: 150px; }');
        htmlParts.push('.qa-section { margin: 10px 0; }');
        htmlParts.push('.question { font-weight: bold; color: #1F2937; margin: 10px 0 5px 0; }');
        htmlParts.push('.answer { color: #059669; margin-left: 20px; padding: 8px; background: #F0FDF4; border-left: 3px solid #10B981; }');
        htmlParts.push('</style></head><body>');
        
        htmlParts.push('<div class="logo-header">');
        htmlParts.push('<img src="data:image/jpeg;base64,' + logoBase64 + '" class="logo-img" alt="FOR ALL HOME CARE AND AGENCY LLC">');
        htmlParts.push('</div>');
        
        htmlParts.push('<h2 style="color: #4F46E5;">Evaluation Report</h2>');
        htmlParts.push('<p><strong>Generated:</strong> ' + new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric', hour: '2-digit', minute: '2-digit' }) + '</p>');
        htmlParts.push('<p><strong>Total Evaluations:</strong> ' + evaluations.length + '</p><hr>');

        evaluations.forEach((ev, index) => {
          htmlParts.push('<div class="evaluation">');
          htmlParts.push('<div class="eval-header">');
          htmlParts.push('<div class="eval-type">' + (ev.evaluationType === 'staff' ? 'Staff/Service Evaluation' : 'Parental Provider Evaluation') + '</div>');
          htmlParts.push('<div style="font-size: 12px; color: #6B7280; margin-top: 5px;">Evaluation #' + (index + 1) + ' - Submitted ' + formatDateTime(ev.submittedAt) + '</div>');
          htmlParts.push('</div>');
          
          htmlParts.push('<div class="info-grid">');
          htmlParts.push('<p><span class="info-label">Evaluation ID:</span>' + ev.id + '</p>');
          htmlParts.push('<p><span class="info-label">Appointment ID:</span>' + ev.appointmentId + '</p>');
          htmlParts.push('<p><span class="info-label">Evaluator:</span>' + ev.evaluatorName + '</p>');
          htmlParts.push('<p><span class="info-label">Parent/Guardian:</span>' + (ev.parentGuardianName || 'N/A') + '</p>');
          htmlParts.push('<p><span class="info-label">Client Name:</span>' + (ev.clientName || 'N/A') + '</p>');
          htmlParts.push('<p><span class="info-label">Service Provider:</span>' + (ev.serviceProviderName || 'N/A') + '</p>');
          htmlParts.push('<p><span class="info-label">Service Types:</span>' + (ev.serviceType || []).join(', ') + '</p>');
          htmlParts.push('<p><span class="info-label">Email:</span>' + ev.email + '</p>');
          htmlParts.push('</div>');
          
          htmlParts.push('<h3 style="color: #4F46E5; border-bottom: 2px solid #E0E7FF; padding-bottom: 5px;">Responses</h3>');
          htmlParts.push('<div class="qa-section">');
          
          (ev.responses || []).forEach((resp, qIndex) => {
            htmlParts.push('<div class="qa-pair" style="display: flex; align-items: baseline; margin-bottom: 8px;"><span class="question" style="font-weight: 500; margin-right: 8px;">' + (qIndex + 1) + '. ' + resp.question + ':</span><span class="answer" style="font-weight: 400; color: #1F2937;">' + resp.answer + '</span></div>');
          });
          
          htmlParts.push('</div>');
          
          if (ev.evaluatorSignature) {
            htmlParts.push('<div style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #E0E7FF;">');
            htmlParts.push('<p style="color: #6B7280; font-size: 14px; margin-bottom: 10px;"><strong>Signature:</strong></p>');
            htmlParts.push('<p style="font-family: \"Brush Script MT\", cursive; font-size: 24px; color: #1F2937; font-style: italic;">' + ev.evaluatorSignature + '</p>');
            htmlParts.push('</div>');
          }
          
          htmlParts.push('</div>');
        });

        htmlParts.push('<div style="text-align: center; color: #6B7280; font-size: 12px; margin-top: 30px;">');
        htmlParts.push('<p>FOR ALL HOME CARE AND AGENCY LLC - Confidential Document</p>');
        htmlParts.push('<p>This report contains ' + evaluations.length + ' evaluation(s)</p>');
        htmlParts.push('</div>');
        
        // Auto-print
        htmlParts.push('<script type="text/javascript">window.onload = function() { window.print(); }<\/script>');
        htmlParts.push('</body></html>');

        const htmlContent = htmlParts.join('');
        const printWindow = window.open('', '_blank');
        printWindow.document.write(htmlContent);
        printWindow.document.close();
      };

      const renderQuestionInput = (q) => {
        if (q.conditional) {
          const parentId = q.id.replace('_desc', '');
          if (evaluationData[parentId] !== 'Yes') {
            return null;
          }
        }

        const createButtons = (options) => (
          <div className={`${options.length > 3 ? 'grid grid-cols-2' : 'flex'} gap-3`}>
            {options.map(opt => (
              <button
                key={opt}
                type="button"
                onClick={() => setEvaluationData({...evaluationData, [q.id]: opt})}
                className={`py-3 rounded-lg border-2 font-semibold transition-all ${
                  evaluationData[q.id] === opt
                    ? 'border-indigo-600 bg-indigo-600 text-white'
                    : 'border-gray-300 bg-white text-gray-700 hover:border-gray-400'
                } ${options.length <= 3 ? 'flex-1' : ''}`}
              >
                {opt}
              </button>
            ))}
          </div>
        );

        switch (q.type) {
          case 'yesnosometimes':
            return createButtons(['Yes', 'No', 'Sometimes']);
          case 'yesnosomewhat':
            return createButtons(['Yes', 'No', 'Somewhat']);
          case 'yesnonotsure':
            return createButtons(['Yes', 'No', 'Not sure']);
          case 'yesnoundecided':
            return createButtons(['Yes', 'No', 'Undecided']);
          case 'yesnopartially':
            return createButtons(['Yes', 'No', 'Partially']);
          case 'alwayssometimesrarely':
            return createButtons(['Always', 'Sometimes', 'Rarely']);
          case 'evvrating':
            return createButtons(['Yes', 'No', 'Sometimes', 'Needs improvement']);
          case 'compensation':
            return createButtons(['Great', 'Fair', 'Unfair', 'Needs improvement']);
          case 'rating5':
            return (
              <div className="flex gap-2">
                {['1 (Poor)', '2', '3', '4', '5 (Excellent)'].map((rating) => (
                  <button
                    key={rating}
                    type="button"
                    onClick={() => setEvaluationData({...evaluationData, [q.id]: rating})}
                    className={`flex-1 py-3 rounded-lg border-2 font-semibold transition-all ${
                      evaluationData[q.id] === rating
                        ? 'border-indigo-600 bg-indigo-600 text-white'
                        : 'border-gray-300 bg-white text-gray-700 hover:border-gray-400'
                    }`}
                  >
                    {rating}
                  </button>
                ))}
              </div>
            );
          case 'textarea':
            return (
              <textarea
                value={evaluationData[q.id] || ''}
                onChange={(e) => setEvaluationData({...evaluationData, [q.id]: e.target.value})}
                rows="3"
                className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none resize-none"
                placeholder="Your response..."
              />
            );
          default:
            return null;
        }
      };

      // ADMIN PANEL
      if (isAdmin) {
        const pendingCount = appointments.filter(a => a.status === 'pending').length;
        const approvedCount = appointments.filter(a => a.status === 'approved').length;

        return (
          <div className="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6">
            <div className="max-w-7xl mx-auto">
              <div className="bg-white rounded-2xl shadow-xl p-6 mb-6">
                <div className="flex items-center justify-between">
                  <div>
                    <h1 className="text-4xl font-bold text-gray-800 mb-2">FOR ALL HOME CARE AND AGENCY LLC</h1>
                    <p className="text-gray-600">Admin Dashboard - Manage appointments and evaluations</p>
                  </div>
                  <button
                    onClick={refreshFromServer}
                    className="flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors"
                    title="Sync data from Supabase"
                  >
                    <RefreshCw className="w-5 h-5" />
                    Refresh from Server
                  </button>
                </div>
              </div>

              {showPowerAppsInfo && (
                <div className="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl shadow-xl p-6 mb-6 text-white">
                  <div className="flex items-start justify-between">
                    <div className="flex-1">
                      <div className="flex items-center gap-2 mb-3">
                        <Cloud className="w-6 h-6" />
                        <h2 className="text-2xl font-bold">Recommended Upgrade: Microsoft Power Apps + Dataverse</h2>
                      </div>
                      <p className="text-blue-100 mb-4">
                        For a professional home care agency system, consider upgrading to Microsoft Power Apps + Dataverse for enhanced security, compliance, and scalability.
                      </p>
                      <div className="grid grid-cols-2 gap-4">
                        <div className="bg-white/10 backdrop-blur-sm p-4 rounded-lg">
                          <div className="flex items-center gap-2 mb-2">
                            <Shield className="w-5 h-5" />
                            <h3 className="font-semibold">HIPAA Compliance</h3>
                          </div>
                          <p className="text-sm text-blue-100">HIPAA-compliant option available for patient data protection</p>
                        </div>
                        <div className="bg-white/10 backdrop-blur-sm p-4 rounded-lg">
                          <div className="flex items-center gap-2 mb-2">
                            <Zap className="w-5 h-5" />
                            <h3 className="font-semibold">Easy Management</h3>
                          </div>
                          <p className="text-sm text-blue-100">No coding required for admins to manage the system</p>
                        </div>
                        <div className="bg-white/10 backdrop-blur-sm p-4 rounded-lg">
                          <div className="flex items-center gap-2 mb-2">
                            <CheckCircle className="w-5 h-5" />
                            <h3 className="font-semibold">Microsoft 365 Integration</h3>
                          </div>
                          <p className="text-sm text-blue-100">Part of Microsoft 365 (you may already have access)</p>
                        </div>
                        <div className="bg-white/10 backdrop-blur-sm p-4 rounded-lg">
                          <div className="flex items-center gap-2 mb-2">
                            <Cloud className="w-5 h-5" />
                            <h3 className="font-semibold">Secure & Automated</h3>
                          </div>
                          <p className="text-sm text-blue-100">Automatic backups, secure cloud storage, connects to Excel & email</p>
                        </div>
                      </div>
                    </div>
                    <button
                      onClick={() => setShowPowerAppsInfo(false)}
                      className="ml-4 text-white/80 hover:text-white transition-colors"
                    >
                      <XCircle className="w-6 h-6" />
                    </button>
                  </div>
                </div>
              )}

              <div className="grid grid-cols-4 gap-4 mb-6">
                <div className="bg-yellow-50 p-5 rounded-xl border border-yellow-200">
                  <p className="text-yellow-800 text-sm font-medium">Pending</p>
                  <p className="text-3xl font-bold text-yellow-900">{pendingCount}</p>
                </div>
                <div className="bg-green-50 p-5 rounded-xl border border-green-200">
                  <p className="text-green-800 text-sm font-medium">Approved</p>
                  <p className="text-3xl font-bold text-green-900">{approvedCount}</p>
                </div>
                <div className="bg-blue-50 p-5 rounded-xl border border-blue-200">
                  <p className="text-blue-800 text-sm font-medium">Total Evaluations</p>
                  <p className="text-3xl font-bold text-blue-900">{evaluations.length}</p>
                </div>
                <div className="bg-purple-50 p-5 rounded-xl border border-purple-200">
                  <p className="text-purple-800 text-sm font-medium">Total Appointments</p>
                  <p className="text-3xl font-bold text-purple-900">{appointments.length}</p>
                </div>
              </div>

              <div className="bg-white rounded-t-2xl shadow-xl">
                <div className="flex border-b border-gray-200">
                  <button
                    onClick={() => setActiveTab('appointments')}
                    className={`flex items-center gap-2 px-8 py-4 font-semibold transition-colors ${
                      activeTab === 'appointments'
                        ? 'text-indigo-600 border-b-2 border-indigo-600'
                        : 'text-gray-500 hover:text-gray-700'
                    }`}
                  >
                    <Calendar className="w-5 h-5" />
                    Appointments
                  </button>
                  <button
                    onClick={() => setActiveTab('evaluations')}
                    className={`flex items-center gap-2 px-8 py-4 font-semibold transition-colors ${
                      activeTab === 'evaluations'
                        ? 'text-indigo-600 border-b-2 border-indigo-600'
                        : 'text-gray-500 hover:text-gray-700'
                    }`}
                  >
                    <ClipboardList className="w-5 h-5" />
                    Evaluations
                  </button>
                </div>

                <div className="p-6">
                  {activeTab === 'evaluations' && (
                    <div className="mb-4 flex gap-3 flex-wrap">
                      <button
                        onClick={exportToWord}
                        className="flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"
                      >
                        <FileText className="w-4 h-4" />
                        Export to Word
                      </button>
                      
                      <button
                        onClick={exportToPDF}
                        className="flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors"
                      >
                        <FileText className="w-4 h-4" />
                        Export to PDF
                      </button>
                    </div>
                  )}

                  {activeTab === 'appointments' && (
                    <div className="space-y-4">
                      {appointments.length === 0 ? (
                        <div className="text-center py-12">
                          <Users className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                          <h3 className="text-xl font-semibold text-gray-600 mb-2">No appointments yet</h3>
                          <p className="text-gray-500">Appointments will appear here when clients submit requests</p>
                        </div>
                      ) : (
                        appointments.sort((a, b) => new Date(b.submittedAt) - new Date(a.submittedAt)).map((apt) => (
                          <div key={apt.id} className="bg-gray-50 rounded-xl p-6 border border-gray-200">
                            <div className="flex items-start justify-between mb-4">
                              <div>
                                <div className="flex items-center gap-3 mb-2">
                                  <h3 className="text-xl font-bold text-gray-800">{apt.clientName}</h3>
                                  <span className={`px-3 py-1 rounded-full text-xs font-semibold ${
                                    apt.status === 'pending' ? 'bg-yellow-100 text-yellow-800' :
                                    apt.status === 'approved' ? 'bg-green-100 text-green-800' :
                                    'bg-red-100 text-red-800'
                                  }`}>
                                    {apt.status.toUpperCase()}
                                  </span>
                                </div>
                                <p className="text-sm text-gray-500">Submitted: {formatDateTime(apt.submittedAt)}</p>
                              </div>
                            </div>

                            <div className="grid grid-cols-2 gap-4 mb-4">
                              <div>
                                <p className="text-sm font-medium text-gray-700">Evaluator</p>
                                <p className="text-gray-900">{apt.evaluatorName}</p>
                              </div>
                              <div>
                                <p className="text-sm font-medium text-gray-700">Parent/Guardian</p>
                                <p className="text-gray-900">{apt.parentGuardianName}</p>
                              </div>
                              <div>
                                <p className="text-sm font-medium text-gray-700">Service Provider</p>
                                <p className="text-gray-900">{apt.serviceProviderName}</p>
                              </div>
                              <div>
                                <p className="text-sm font-medium text-gray-700">Appointment</p>
                                <p className="text-gray-900 font-semibold">{formatDate(apt.appointmentDate)}</p>
                                <p className="text-gray-900 font-semibold">{formatTime(apt.appointmentTime)}</p>
                              </div>
                              <div>
                                <p className="text-sm font-medium text-gray-700">Contact</p>
                                <p className="text-gray-900">{apt.email}</p>
                                <p className="text-gray-900">{apt.phone}</p>
                              </div>
                              <div>
                                <p className="text-sm font-medium text-gray-700">Service Types</p>
                                <p className="text-gray-900">{apt.serviceType.join(', ')}</p>
                              </div>
                              <div className="col-span-2">
                                <p className="text-sm font-medium text-gray-700">Address</p>
                                <p className="text-gray-900">{apt.address}</p>
                              </div>
                              {apt.notes && (
                                <div className="col-span-2">
                                  <p className="text-sm font-medium text-gray-700">Notes</p>
                                  <p className="text-gray-900 bg-white p-3 rounded border">{apt.notes}</p>
                                </div>
                              )}
                            </div>

                            <div className="flex gap-2">
                              {apt.status === 'pending' && (
                                <>
                                  <button
                                    onClick={() => updateAppointmentStatus(apt.id, 'approved')}
                                    className="flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm"
                                  >
                                    <CheckCircle className="w-4 h-4" />
                                    Approve
                                  </button>
                                  <button
                                    onClick={() => updateAppointmentStatus(apt.id, 'declined')}
                                    className="flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm"
                                  >
                                    <XCircle className="w-4 h-4" />
                                    Decline
                                  </button>
                                </>
                              )}
                              <button
                                onClick={() => deleteAppointment(apt.id)}
                                className="ml-auto flex items-center gap-2 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors text-sm"
                              >
                                <Trash2 className="w-4 h-4" />
                                Delete
                              </button>
                            </div>
                          </div>
                        ))
                      )}
                    </div>
                  )}

                  {activeTab === 'evaluations' && (
                    <div className="space-y-4">
                      {evaluations.length === 0 ? (
                        <div className="text-center py-12">
                          <FileText className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                          <h3 className="text-xl font-semibold text-gray-600 mb-2">No evaluations yet</h3>
                          <p className="text-gray-500">Evaluation forms will appear here when submitted</p>
                        </div>
                      ) : (
                        evaluations.sort((a, b) => new Date(b.submittedAt) - new Date(a.submittedAt)).map((ev) => (
                          <div key={ev.id} className="bg-gray-50 rounded-xl p-6 border border-gray-200">
                            <div className="flex items-start justify-between mb-4">
                              <div className="flex-1">
                                <h3 className="text-xl font-bold text-gray-800 mb-1">{ev.clientName}</h3>
                                <div className="grid grid-cols-2 gap-x-4 text-sm text-gray-600 mb-3">
                                  <p><span className="font-medium">Evaluator:</span> {ev.evaluatorName}</p>
                                  <p><span className="font-medium">Parent/Guardian:</span> {ev.parentGuardianName}</p>
                                  <p><span className="font-medium">Service Provider:</span> {ev.serviceProviderName}</p>
                                  <p><span className="font-medium">Email:</span> {ev.email}</p>
                                  <p className="col-span-2"><span className="font-medium">Services:</span> {ev.serviceType.join(', ')}</p>
                                </div>
                                <div className="flex items-center gap-2">
                                  <span className="px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full text-xs font-semibold">
                                    {ev.evaluationType === 'staff' ? 'Staff/Service Evaluation' : 'Parental Provider Evaluation'}
                                  </span>
                                  <span className="text-sm text-gray-500">
                                    {formatDateTime(ev.submittedAt)}
                                  </span>
                                </div>
                              </div>
                              <button
                                onClick={() => deleteEvaluation(ev.id)}
                                className="flex items-center gap-2 bg-gray-300 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-400 transition-colors text-sm"
                              >
                                <Trash2 className="w-4 h-4" />
                              </button>
                            </div>

                            <div className="space-y-3">
                              {ev.responses.filter(r => r.answer !== 'Not answered').map((resp, idx) => (
                                <div key={idx} className="flex flex-row flex-wrap items-baseline bg-white p-4 rounded-lg border mb-2">
                                  <span className="text-sm font-medium text-gray-700 mr-2">{idx + 1}. {resp.question}:</span>
                                  <span className="text-gray-900 font-semibold">{resp.answer}</span>
                                </div>
                              ))}
                            </div>

                            {ev.evaluatorSignature && (
                              <div className="mt-6 pt-4 border-t border-gray-300">
                                <p className="text-sm font-medium text-gray-700 mb-2">Evaluator Signature</p>
                                <p className="text-2xl italic font-handwriting text-gray-800">{ev.evaluatorSignature}</p>
                              </div>
                            )}
                          </div>
                        ))
                      )}
                    </div>
                  )}
                </div>
              </div>
            </div>
          </div>
        );
      }

      // SUCCESS SCREEN
      if (submitted) {
        return (
          <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
            <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-2xl w-full text-center">
              <div className="mb-6">
                <div className="mx-auto w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mb-4">
                  <CheckCircle className="w-12 h-12 text-green-600" />
                </div>
                <h2 className="text-3xl font-bold text-gray-800 mb-2">Thank You!</h2>
                <p className="text-gray-600">Your appointment request and evaluation have been submitted successfully to FOR ALL HOME CARE AND AGENCY LLC.</p>
              </div>

              <div className="bg-indigo-50 rounded-lg p-6 mb-6 text-left">
                <h3 className="font-semibold text-indigo-900 mb-3">Submission Summary</h3>
                <div className="space-y-2 text-sm">
                  <p><span className="font-medium text-gray-700">Client Name:</span> <span className="text-gray-600">{clientInfo.clientName}</span></p>
                  <p><span className="font-medium text-gray-700">Parent/Guardian:</span> <span className="text-gray-600">{clientInfo.parentGuardianName}</span></p>
                  <p><span className="font-medium text-gray-700">Service Provider:</span> <span className="text-gray-600">{clientInfo.serviceProviderName}</span></p>
                  <p><span className="font-medium text-gray-700">Email:</span> <span className="text-gray-600">{clientInfo.email}</span></p>
                  <p><span className="font-medium text-gray-700">Appointment:</span> <span className="text-gray-600">{formatDate(clientInfo.appointmentDate)} at {formatTime(clientInfo.appointmentTime)}</span></p>
                  <p><span className="font-medium text-gray-700">Service Types:</span> <span className="text-gray-600">{clientInfo.serviceType.join(', ')}</span></p>
                  <p><span className="font-medium text-gray-700">Evaluation Type:</span> <span className="text-gray-600">{evaluationType === 'staff' ? 'Staff/Service Evaluation' : 'Parental Provider Evaluation'}</span></p>
                </div>
              </div>

              <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                <p className="text-sm text-blue-800">
                  Our team will review your request and contact you at <strong>{clientInfo.email}</strong> or <strong>{clientInfo.phone}</strong> within 24 hours to confirm your appointment.
                </p>
              </div>

              <button
                onClick={handleReset}
                className="w-full bg-indigo-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-indigo-700 transition-colors"
              >
                Submit Another Form
              </button>
            </div>
          </div>
        );
      }

      // CLIENT FORM
      return (
        <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
          <div className="max-w-4xl mx-auto">
            {showPowerAppsInfo && (
              <div className="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl shadow-xl p-6 mb-6 text-white">
                <div className="flex items-start justify-between">
                  <div className="flex-1">
                    <div className="flex items-center gap-2 mb-3">
                      <Info className="w-6 h-6" />
                      <h2 className="text-xl font-bold">System Information</h2>
                    </div>
                    <p className="text-blue-100 mb-3">
                      This agency is exploring Microsoft Power Apps + Dataverse for enhanced security and compliance.
                    </p>
                    <div className="flex flex-wrap gap-2">
                      <span className="bg-white/20 px-3 py-1 rounded-full text-sm font-medium">âœ“ HIPAA Compliant</span>
                      <span className="bg-white/20 px-3 py-1 rounded-full text-sm font-medium">âœ“ Secure Cloud Storage</span>
                      <span className="bg-white/20 px-3 py-1 rounded-full text-sm font-medium">âœ“ Microsoft 365 Integration</span>
                      <span className="bg-white/20 px-3 py-1 rounded-full text-sm font-medium">âœ“ Automatic Backups</span>
                    </div>
                  </div>
                  <button
                    onClick={() => setShowPowerAppsInfo(false)}
                    className="ml-4 text-white/80 hover:text-white transition-colors"
                  >
                    <XCircle className="w-6 h-6" />
                  </button>
                </div>
              </div>
            )}

            <div className="bg-white rounded-2xl shadow-2xl p-8">
              <div className="text-center mb-8">
                <h1 className="text-3xl font-bold text-gray-800 mb-2">FOR ALL HOME CARE AND AGENCY LLC</h1>
                <p className="text-xl text-gray-700 mb-1">Appointment Request & Evaluation Form</p>
                <p className="text-gray-600">Complete your appointment request and evaluation in one form</p>
              </div>

              <form onSubmit={handleSubmit} className="space-y-6">
                <div className="bg-gray-50 p-6 rounded-xl">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">Form Information</h2>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">Evaluation Filled by (Your Name) *</label>
                      <input
                        type="text"
                        value={clientInfo.evaluatorName}
                        onChange={(e) => setClientInfo({...clientInfo, evaluatorName: e.target.value})}
                        className={`w-full px-4 py-3 border ${errors.evaluatorName ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none`}
                        placeholder="Your name"
                      />
                      {errors.evaluatorName && <p className="mt-1 text-sm text-red-600">{errors.evaluatorName}</p>}
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">Signature</label>
                      <input
                        type="text"
                        value={clientInfo.evaluatorSignature}
                        onChange={(e) => setClientInfo({...clientInfo, evaluatorSignature: e.target.value})}
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
                        placeholder="Type your name as signature"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">Parent/Guardian Name *</label>
                      <input
                        type="text"
                        value={clientInfo.parentGuardianName}
                        onChange={(e) => setClientInfo({...clientInfo, parentGuardianName: e.target.value})}
                        className={`w-full px-4 py-3 border ${errors.parentGuardianName ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none`}
                        placeholder="Parent or guardian name"
                      />
                      {errors.parentGuardianName && <p className="mt-1 text-sm text-red-600">{errors.parentGuardianName}</p>}
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">Client Name *</label>
                      <input
                        type="text"
                        value={clientInfo.clientName}
                        onChange={(e) => setClientInfo({...clientInfo, clientName: e.target.value})}
                        className={`w-full px-4 py-3 border ${errors.clientName ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none`}
                        placeholder="Client receiving services"
                      />
                      {errors.clientName && <p className="mt-1 text-sm text-red-600">{errors.clientName}</p>}
                    </div>

                    <div className="col-span-2">
                      <label className="block text-sm font-medium text-gray-700 mb-2">Service Provider Name *</label>
                      <input
                        type="text"
                        value={clientInfo.serviceProviderName}
                        onChange={(e) => setClientInfo({...clientInfo, serviceProviderName: e.target.value})}
                        className={`w-full px-4 py-3 border ${errors.serviceProviderName ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none`}
                        placeholder="Name of staff providing services"
                      />
                      {errors.serviceProviderName && <p className="mt-1 text-sm text-red-600">{errors.serviceProviderName}</p>}
                    </div>
                  </div>
                </div>

                <div className="bg-gray-50 p-6 rounded-xl">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">Service Type(s) *</h2>
                  <div className="grid grid-cols-2 gap-3">
                    {serviceTypes.map(type => (
                      <button
                        key={type}
                        type="button"
                        onClick={() => toggleServiceType(type)}
                        className={`p-3 rounded-lg border-2 transition-all text-left ${
                          clientInfo.serviceType.includes(type)
                            ? 'border-indigo-600 bg-indigo-50 text-indigo-900 font-semibold'
                            : 'border-gray-300 bg-white text-gray-700 hover:border-gray-400'
                        }`}
                      >
                        <span className="text-sm">{clientInfo.serviceType.includes(type) ? 'â˜‘' : 'â˜'}</span> {type}
                      </button>
                    ))}
                  </div>
                  {errors.serviceType && <p className="mt-2 text-sm text-red-600">{errors.serviceType}</p>}
                </div>

                <div className="bg-gray-50 p-6 rounded-xl">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">Contact Information</h2>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">Email *</label>
                      <input
                        type="email"
                        value={clientInfo.email}
                        onChange={(e) => setClientInfo({...clientInfo, email: e.target.value})}
                        className={`w-full px-4 py-3 border ${errors.email ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none`}
                        placeholder="your@email.com"
                      />
                      {errors.email && <p className="mt-1 text-sm text-red-600">{errors.email}</p>}
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">Phone *</label>
                      <input
                        type="tel"
                        value={clientInfo.phone}
                        onChange={(e) => setClientInfo({...clientInfo, phone: e.target.value})}
                        className={`w-full px-4 py-3 border ${errors.phone ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none`}
                        placeholder="(555) 123-4567"
                      />
                      {errors.phone && <p className="mt-1 text-sm text-red-600">{errors.phone}</p>}
                    </div>

                    <div className="col-span-2">
                      <label className="block text-sm font-medium text-gray-700 mb-2">Address *</label>
                      <textarea
                        value={clientInfo.address}
                        onChange={(e) => setClientInfo({...clientInfo, address: e.target.value})}
                        rows="2"
                        className={`w-full px-4 py-3 border ${errors.address ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none resize-none`}
                        placeholder="123 Main St, City, State, ZIP"
                      />
                      {errors.address && <p className="mt-1 text-sm text-red-600">{errors.address}</p>}
                    </div>
                  </div>
                </div>

                <div className="bg-gray-50 p-6 rounded-xl">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">Appointment Details</h2>
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">Date of Evaluation *</label>
                      <input
                        type="date"
                        value={clientInfo.appointmentDate}
                        onChange={(e) => {
                          const selectedDate = new Date(e.target.value);
                          const dayOfWeek = selectedDate.getDay(); // 0 = Sunday
                          if (dayOfWeek === 0) {
                            alert('The agency is not working on Sundays. Please pick a working day instead.');
                            setClientInfo({...clientInfo, appointmentDate: ''});
                            return;
                          }
                          setClientInfo({...clientInfo, appointmentDate: e.target.value});
                        }}
                        min={today}
                        max={maxDateStr}
                        className={`w-full px-4 py-3 border ${errors.appointmentDate ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none`}
                      />
                      {errors.appointmentDate && <p className="mt-1 text-sm text-red-600">{errors.appointmentDate}</p>}
                    </div>

                    <div>
                      <label className="block text-sm font-medium text-gray-700 mb-2">Preferred Time *</label>
                      <input
                        type="time"
                        value={clientInfo.appointmentTime}
                        onChange={(e) => setClientInfo({...clientInfo, appointmentTime: e.target.value})}
                        className={`w-full px-4 py-3 border ${errors.appointmentTime ? 'border-red-500' : 'border-gray-300'} rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none`}
                      />
                      {errors.appointmentTime && <p className="mt-1 text-sm text-red-600">{errors.appointmentTime}</p>}
                    </div>

                    <div className="col-span-2">
                      <label className="block text-sm font-medium text-gray-700 mb-2">Additional Notes</label>
                      <textarea
                        value={clientInfo.notes}
                        onChange={(e) => setClientInfo({...clientInfo, notes: e.target.value})}
                        rows="3"
                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none resize-none"
                        placeholder="Any special requirements or information..."
                      />
                    </div>
                  </div>
                </div>

                <div className="bg-indigo-50 p-6 rounded-xl border-2 border-indigo-200">
                  <h2 className="text-2xl font-bold text-gray-800 mb-4">Evaluation Form</h2>
                  
                  <div className="mb-6">
                    <label className="block text-sm font-medium text-gray-700 mb-3">Select Evaluation Type *</label>
                    <div className="grid grid-cols-2 gap-4">
                      <button
                        type="button"
                        onClick={() => setEvaluationType('staff')}
                        className={`p-4 rounded-lg border-2 transition-all ${
                          evaluationType === 'staff'
                            ? 'border-indigo-600 bg-indigo-600 text-white'
                            : 'border-gray-300 bg-white hover:border-gray-400'
                        }`}
                      >
                        <h3 className="font-bold">Staff / Service Evaluation</h3>
                        <p className="text-sm mt-1">For families evaluating staff who provide services in the home</p>
                      </button>
                      <button
                        type="button"
                        onClick={() => setEvaluationType('parental')}
                        className={`p-4 rounded-lg border-2 transition-all ${
                          evaluationType === 'parental'
                            ? 'border-indigo-600 bg-indigo-600 text-white'
                            : 'border-gray-300 bg-white hover:border-gray-400'
                        }`}
                      >
                        <h3 className="font-bold">Parental Provider Evaluation</h3>
                        <p className="text-sm mt-1">For parents or guardians who provide services through the agency</p>
                      </button>
                    </div>
                  </div>

                  <div className="space-y-5">
                    {currentQuestions.map((q) => {
                      const input = renderQuestionInput(q);
                      if (!input) return null;

                      return (
                        <div key={q.id} className="bg-white p-5 rounded-lg border border-gray-200">
                          <label className="block text-sm font-medium text-gray-800 mb-3">
                            {q.question} {!q.conditional && q.type !== 'textarea' && '*'}
                          </label>
                          {input}
                          {errors[q.id] && <p className="mt-2 text-sm text-red-600">{errors[q.id]}</p>}
                        </div>
                      );
                    })}
                  </div>

                  {/* Evaluation Signature Field */}
                  <div className="bg-white p-5 rounded-lg border border-gray-200 mt-5">
                    <label className="block text-sm font-medium text-gray-800 mb-3">
                      Evaluator Signature *
                    </label>
                    <input
                      type="text"
                      value={evaluationData.evaluatorSignature || ''}
                      onChange={(e) => setEvaluationData({...evaluationData, evaluatorSignature: e.target.value})}
                      placeholder="Enter your signature or initials"
                      className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-indigo-600 focus:ring-2 focus:ring-indigo-100"
                      required
                    />
                  </div>
                </div>

                <button
                  type="submit"
                  className="w-full bg-indigo-600 text-white py-4 px-6 rounded-lg font-bold text-lg hover:bg-indigo-700 transition-colors shadow-lg hover:shadow-xl"
                >
                  Submit Appointment & Evaluation Form
                </button>
              </form>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<HomeCareAgencySystem />, document.getElementById('root'));
  </script>
</body>
</html>
